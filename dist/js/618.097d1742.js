"use strict";(self["webpackChunkwebot"]=self["webpackChunkwebot"]||[]).push([[618],{9618(e,a,l){l.r(a),l.d(a,{default:()=>Aa});var t=l(6768),s=l(4232),n=l(144),o=l(1219),u=l(7477);const c={class:"selected-targets-panel"},i={class:"panel-header"},d={class:"header-actions"},r={class:"panel-content"},v={key:0,class:"empty-state"},k={key:1,class:"selections-container"},m={key:0,class:"selection-group"},p={class:"group-header"},g={class:"group-title"},f={class:"count-badge"},b={class:"selected-items horizontal-items"},h={class:"item-name"},_={key:0,class:"more-items"},y={class:"more-text"},w={key:1,class:"selection-group"},L={class:"group-header"},F={class:"group-title"},V={class:"count-badge"},C={class:"selected-items horizontal-items"},E={class:"item-name"},x={key:0,class:"more-items"},W={class:"more-text"},R=5,K=(0,t.pM)({__name:"SelectedTargetsPanel",props:{selectedFriends:{default:()=>[]},selectedGroups:{default:()=>[]}},emits:["remove-friend","remove-group","clear-all","set-group-tag"],setup(e,{emit:a}){const l=e,n=(0,t.EW)(()=>l.selectedFriends.length>0||l.selectedGroups.length>0),o=(0,t.EW)(()=>l.selectedGroups.length>0&&0===l.selectedFriends.length),u=(0,t.EW)(()=>l.selectedFriends.slice(0,R)),K=(0,t.EW)(()=>l.selectedGroups.slice(0,R));return(a,l)=>{const I=(0,t.g2)("el-button");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.Lk)("div",i,[l[4]||(l[4]=(0,t.Lk)("h3",{class:"panel-title"},"é€‰æ‹©ç›®æ ‡",-1)),(0,t.Lk)("div",d,[(0,t.bF)(I,{type:"primary",plain:"",size:"small",class:"set-group-tag-btn",disabled:!o.value,onClick:l[0]||(l[0]=e=>a.$emit("set-group-tag"))},{default:(0,t.k6)(()=>[...l[2]||(l[2]=[(0,t.eW)(" è®¾ç½®ç¾¤æ ‡ç­¾ ",-1)])]),_:1},8,["disabled"]),(0,t.bF)(I,{type:"text",onClick:l[1]||(l[1]=e=>a.$emit("clear-all")),class:"clear-all-btn",size:"small"},{default:(0,t.k6)(()=>[...l[3]||(l[3]=[(0,t.eW)(" æ¸…ç©º ",-1)])]),_:1})])]),(0,t.Lk)("div",r,[n.value?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",v,[...l[5]||(l[5]=[(0,t.Lk)("div",{class:"empty-icon"},"ğŸ“‹",-1),(0,t.Lk)("div",{class:"empty-text"},"é€‰æ‹©å¥½å‹æˆ–ç¾¤èŠ",-1),(0,t.Lk)("div",{class:"empty-hint"},"è¿›è¡Œæ‰¹é‡æ“ä½œ",-1)])])),n.value?((0,t.uX)(),(0,t.CE)("div",k,[e.selectedFriends.length>0?((0,t.uX)(),(0,t.CE)("div",m,[(0,t.Lk)("div",p,[(0,t.Lk)("div",g,[l[6]||(l[6]=(0,t.Lk)("span",{class:"title-text"},"å·²é€‰æ‹©çš„å¥½å‹",-1)),(0,t.Lk)("span",f,(0,s.v_)(e.selectedFriends.length),1)])]),(0,t.Lk)("div",b,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(u.value,e=>((0,t.uX)(),(0,t.CE)("div",{key:e,class:"selected-item friend-item"},[(0,t.Lk)("span",h,(0,s.v_)(e),1)]))),128)),e.selectedFriends.length>R?((0,t.uX)(),(0,t.CE)("div",_,[(0,t.Lk)("span",y,"...ç­‰"+(0,s.v_)(e.selectedFriends.length)+"äºº",1)])):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0),e.selectedGroups.length>0?((0,t.uX)(),(0,t.CE)("div",w,[(0,t.Lk)("div",L,[(0,t.Lk)("div",F,[l[7]||(l[7]=(0,t.Lk)("span",{class:"title-text"},"å·²é€‰æ‹©çš„ç¾¤èŠ",-1)),(0,t.Lk)("span",V,(0,s.v_)(e.selectedGroups.length),1)])]),(0,t.Lk)("div",C,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(K.value,e=>((0,t.uX)(),(0,t.CE)("div",{key:e,class:"selected-item group-item"},[(0,t.Lk)("span",E,(0,s.v_)(e),1)]))),128)),e.selectedGroups.length>R?((0,t.uX)(),(0,t.CE)("div",x,[(0,t.Lk)("span",W,"...ç­‰"+(0,s.v_)(e.selectedGroups.length)+"ä¸ªç¾¤",1)])):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0)])):(0,t.Q3)("",!0)])])}}});var I=l(1241);const X=(0,I.A)(K,[["__scopeId","data-v-61d7d18a"]]),A=X;var S=l(5142);const $=async e=>{try{const a=await fetch(`${S.JR}/api/tasks/sync-contacts`,{method:"POST",headers:S.b3,body:JSON.stringify(e)});if(!a.ok){const e=await a.json();throw new Error(e.error||"åˆ›å»ºè‡ªåŠ¨åŒæ­¥ä»»åŠ¡å¤±è´¥")}return await a.json()}catch(a){throw console.error("åˆ›å»ºè‡ªåŠ¨åŒæ­¥ä»»åŠ¡å¤±è´¥:",a),a}},U=async()=>{try{const e=await fetch(`${S.JR}/api/tasks/sync-contacts/status`,{method:"GET",headers:S.b3});if(!e.ok){const a=await e.json();throw new Error(a.error||"è·å–è‡ªåŠ¨åŒæ­¥ä»»åŠ¡çŠ¶æ€å¤±è´¥")}const a=await e.json();return a.task||null}catch(e){throw console.error("è·å–è‡ªåŠ¨åŒæ­¥ä»»åŠ¡çŠ¶æ€å¤±è´¥:",e),e}},z=async e=>{try{const a=await fetch(`${S.JR}/api/tasks/sync-contacts/${e}/cancel`,{method:"POST",headers:S.b3});if(!a.ok){const e=await a.json();throw new Error(e.error||"å–æ¶ˆè‡ªåŠ¨åŒæ­¥ä»»åŠ¡å¤±è´¥")}return await a.json()}catch(a){throw console.error("å–æ¶ˆè‡ªåŠ¨åŒæ­¥ä»»åŠ¡å¤±è´¥:",a),a}},H={class:"operations-panel"},T={class:"panel-content"},G={class:"horizontal-operations"},M={class:"mass-send-section"},B=["disabled"],q={class:"batch-operations-section"},Q={class:"batch-buttons"},D=["disabled"],j=["disabled"],O={class:"settings-section"},P={class:"settings-content"},J={key:0,class:"settings-status"},N={key:0,class:"operation-tips"},Z=(0,t.pM)({__name:"OperationsPanel",props:{selectedFriends:{default:()=>[]},selectedGroups:{default:()=>[]}},emits:["mass-send","batch-group","auto-follow","batch-tag","delete","open-settings"],setup(e,{emit:a}){const l=e,s=(0,n.KR)(!1),o=async()=>{try{const e=await U();s.value=!!e}catch(e){console.error("æŸ¥è¯¢è‡ªåŠ¨åŒæ­¥çŠ¶æ€å¤±è´¥:",e),s.value=!1}},u=(0,t.EW)(()=>l.selectedFriends.length>0||l.selectedGroups.length>0),c=(0,t.EW)(()=>l.selectedFriends.length>0),i=(0,t.EW)(()=>l.selectedGroups.length>0),d=(0,t.EW)(()=>c.value&&i.value),r=(0,t.EW)(()=>u.value),v=(0,t.EW)(()=>c.value&&!i.value),k=(0,t.EW)(()=>c.value&&!i.value),m=((0,t.EW)(()=>c.value&&!i.value),(0,t.EW)(()=>u.value),(0,t.EW)(()=>!d.value)),p=(0,t.EW)(()=>d.value||i.value&&!c.value?"éƒ¨åˆ†æ“ä½œä»…æ”¯æŒå¥½å‹":"");return(0,t.sV)(()=>{o()}),(e,a)=>{const l=(0,t.g2)("el-alert");return(0,t.uX)(),(0,t.CE)("div",H,[a[11]||(a[11]=(0,t.Lk)("div",{class:"panel-header"},[(0,t.Lk)("h3",{class:"panel-title"},"æ‰¹é‡æ“ä½œ")],-1)),(0,t.Lk)("div",T,[(0,t.Lk)("div",G,[(0,t.Lk)("div",M,[(0,t.Lk)("button",{disabled:!r.value,onClick:a[0]||(a[0]=a=>e.$emit("mass-send")),class:"action-btn action-btn-primary"},[...a[4]||(a[4]=[(0,t.Lk)("svg",{class:"action-btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,t.Lk)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}),(0,t.Lk)("path",{d:"M8 10h8M8 14h4"})],-1),(0,t.Lk)("span",{class:"action-btn-text"},"ç¾¤å‘æ¶ˆæ¯",-1)])],8,B)]),a[9]||(a[9]=(0,t.Lk)("div",{class:"vertical-divider"},null,-1)),(0,t.Lk)("div",q,[(0,t.Lk)("div",Q,[(0,t.Lk)("button",{disabled:!v.value,onClick:a[1]||(a[1]=a=>e.$emit("batch-group")),class:"action-btn action-btn-secondary batch-btn"},[...a[5]||(a[5]=[(0,t.Lk)("svg",{class:"action-btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,t.Lk)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})],-1),(0,t.Lk)("span",{class:"action-btn-text"},"æ‰¹é‡æ‹‰ç¾¤",-1)])],8,D),(0,t.Lk)("button",{disabled:!k.value,onClick:a[2]||(a[2]=a=>e.$emit("auto-follow")),class:"action-btn action-btn-secondary batch-btn"},[...a[6]||(a[6]=[(0,t.Lk)("svg",{class:"action-btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,t.Lk)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,t.Lk)("circle",{cx:"12",cy:"7",r:"4"})],-1),(0,t.Lk)("span",{class:"action-btn-text"},"è‡ªåŠ¨è·Ÿå•",-1)])],8,j)])]),a[10]||(a[10]=(0,t.Lk)("div",{class:"vertical-divider"},null,-1)),(0,t.Lk)("div",O,[(0,t.Lk)("button",{onClick:a[3]||(a[3]=a=>e.$emit("open-settings")),class:"settings-btn"},[(0,t.Lk)("div",P,[a[8]||(a[8]=(0,t.Fv)('<div class="settings-icon-title" data-v-1d5534de><svg class="settings-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1d5534de><circle cx="12" cy="12" r="3" data-v-1d5534de></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" data-v-1d5534de></path></svg><span class="settings-title" data-v-1d5534de>è®¾ç½®</span></div>',1)),s.value?((0,t.uX)(),(0,t.CE)("div",J,[...a[7]||(a[7]=[(0,t.Lk)("span",{class:"status-text"},"è‡ªåŠ¨åŒæ­¥",-1)])])):(0,t.Q3)("",!0)])])])]),u.value&&!m.value?((0,t.uX)(),(0,t.CE)("div",N,[(0,t.bF)(l,{title:p.value,type:"info",closable:!1,"show-icon":"",class:"tip-alert"},null,8,["title"])])):(0,t.Q3)("",!0)])])}}}),Y=(0,I.A)(Z,[["__scopeId","data-v-1d5534de"]]),ee=Y;var ae=l(4962);const le={class:"countdown-content"},te={class:"countdown-message"},se={class:"countdown-number"},ne=(0,t.pM)({__name:"CountdownDialog",props:{modelValue:{type:Boolean},countdown:{},message:{}},emits:["update:modelValue","finish"],setup(e,{emit:a}){const l=e,o=a,u=(0,n.KR)(!1),c=(0,n.KR)(l.countdown||5);(0,t.wB)(()=>l.modelValue,e=>{u.value=e,e&&i()});const i=()=>{c.value=l.countdown||5;const e=setInterval(()=>{c.value--,c.value<=0&&(clearInterval(e),u.value=!1,o("update:modelValue",!1),o("finish"))},1e3)};return(a,l)=>{const n=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.Wv)(n,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value=e),"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"400px",class:"countdown-dialog"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",le,[(0,t.Lk)("div",te,(0,s.v_)(e.message),1),(0,t.Lk)("div",se,(0,s.v_)(c.value),1),l[1]||(l[1]=(0,t.Lk)("div",{class:"countdown-tip"},"ç§’åå¼€å§‹æ‰§è¡Œï¼Œè¯·ç¡®ä¿å¾®ä¿¡çª—å£æ‰“å¼€",-1))])]),_:1},8,["modelValue"])}}}),oe=(0,I.A)(ne,[["__scopeId","data-v-68a0851c"]]),ue=oe,ce={class:"warning-section"},ie={class:"sync-section"},de={class:"section-content"},re={class:"account-selector"},ve={class:"sync-buttons"},ke={class:"auto-sync-section"},me={class:"section-content"},pe={class:"sync-items-config"},ge={class:"sync-frequency-config"},fe={class:"time-range-config"},be={key:0,class:"next-execution-time"},he={class:"execution-time"},_e={class:"auto-sync-toggle"},ye={class:"dialog-footer"},we=(0,t.pM)({__name:"SyncContactsDialog",props:{modelValue:{type:Boolean},accounts:{},defaultAccountId:{}},emits:["update:modelValue","sync"],setup(e,{emit:a}){const l=e,u=a,c=(0,n.KR)(!1),i=(0,n.KR)(""),d=(0,n.KR)(!1),r=(0,n.KR)(""),v=(0,n.KR)("friend"),k=(0,n.KR)(!1),m=(0,n.KR)(new Date(2024,0,1,2,0)),p=(0,n.KR)(new Date(2024,0,1,4,0)),g=(0,n.KR)(["group"]),f=(0,n.KR)(7),b=(0,n.KR)(""),h=()=>{if(k.value)return;const e=m.value;if(!e)return;const a=new Date(e);a.setHours(a.getHours()+2),p.value=a};(0,t.wB)(m,()=>{h()}),(0,t.wB)(()=>l.modelValue,e=>{if(c.value=e,e&&l.accounts.length>0){const e=l.defaultAccountId,a=e&&l.accounts.some(a=>a.account_id===e);i.value=a?e:l.accounts[0].account_id,_()}}),(0,t.wB)(c,e=>{u("update:modelValue",e)});const _=async()=>{try{const e=await U();if(console.log("è·å–åˆ°çš„ä»»åŠ¡çŠ¶æ€:",e),e){k.value=!0;const a=e.params?.sync_config||{};if(g.value=a.sync_items||["group"],f.value=a.sync_frequency||7,a.time_range_start&&a.time_range_end){const[e,l]=a.time_range_start.split(":"),[t,s]=a.time_range_end.split(":");m.value=new Date(2024,0,1,parseInt(e),parseInt(l)),p.value=new Date(2024,0,1,parseInt(t),parseInt(s))}if(e.next_run_time){const a=new Date(e.next_run_time);b.value=a.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}else b.value=""}else k.value=!1,b.value=""}catch(e){console.error("æŸ¥è¯¢è‡ªåŠ¨åŒæ­¥çŠ¶æ€å¤±è´¥:",e),k.value=!1,b.value=""}},y=async e=>{const a=Boolean(e);if(a){if(0===g.value.length)return o.nk.warning("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªåŒæ­¥é¡¹"),void(k.value=!1);try{const e={sync_items:g.value,sync_frequency:f.value,time_range_start:`${m.value.getHours().toString().padStart(2,"0")}:${m.value.getMinutes().toString().padStart(2,"0")}`,time_range_end:`${p.value.getHours().toString().padStart(2,"0")}:${p.value.getMinutes().toString().padStart(2,"0")}`,enabled:!0},a=await $(e);a.success?(o.nk.success("è‡ªåŠ¨åŒæ­¥å·²å¼€å¯"),b.value=a.next_execution_time||"",await _()):(o.nk.error(a.error||"å¼€å¯è‡ªåŠ¨åŒæ­¥å¤±è´¥"),k.value=!1)}catch(l){console.error("å¼€å¯è‡ªåŠ¨åŒæ­¥å¤±è´¥:",l),o.nk.error(`å¼€å¯è‡ªåŠ¨åŒæ­¥å¤±è´¥: ${l.message||"æœªçŸ¥é”™è¯¯"}`),k.value=!1}}else try{const e=await U();e?(await z(e.id),o.nk.success("è‡ªåŠ¨åŒæ­¥å·²å…³é—­")):o.nk.info("æ²¡æœ‰æ‰¾åˆ°æ´»è·ƒçš„è‡ªåŠ¨åŒæ­¥ä»»åŠ¡"),b.value="",await _()}catch(l){console.error("å…³é—­è‡ªåŠ¨åŒæ­¥å¤±è´¥:",l),o.nk.error(`å…³é—­è‡ªåŠ¨åŒæ­¥å¤±è´¥: ${l.message||"æœªçŸ¥é”™è¯¯"}`),k.value=!0}},w=e=>{i.value&&(v.value=e,r.value="friend"===e?"å‡†å¤‡åŒæ­¥å¥½å‹æ•°æ®":"å‡†å¤‡åŒæ­¥ç¾¤èŠæ•°æ®",c.value=!1,d.value=!0)},L=()=>{u("sync",{accountId:i.value,type:v.value})},F=()=>{c.value=!1};return(a,l)=>{const n=(0,t.g2)("el-alert"),o=(0,t.g2)("el-option"),u=(0,t.g2)("el-select"),v=(0,t.g2)("el-button"),h=(0,t.g2)("el-checkbox"),_=(0,t.g2)("el-checkbox-group"),V=(0,t.g2)("el-input-number"),C=(0,t.g2)("el-time-picker"),E=(0,t.g2)("el-switch"),x=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(x,{modelValue:c.value,"onUpdate:modelValue":l[8]||(l[8]=e=>c.value=e),title:"åŒæ­¥é€šè®¯å½•",width:"500px","close-on-click-modal":!1,class:"sync-contacts-dialog"},{footer:(0,t.k6)(()=>[(0,t.Lk)("div",ye,[(0,t.bF)(v,{onClick:F},{default:(0,t.k6)(()=>[...l[26]||(l[26]=[(0,t.eW)("å…³é—­",-1)])]),_:1})])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",ce,[(0,t.bF)(n,{type:"info","show-icon":"",closable:!1,class:"warning-banner"},{default:(0,t.k6)(()=>[...l[10]||(l[10]=[(0,t.Lk)("span",{class:"warning-text"},"æ‰€æœ‰å¾®ä¿¡é€šè®¯å½•æ•°æ®å‡ä¿å­˜æœ¬åœ°ï¼Œç»ä¸ä¼šä¸Šä¼ æœåŠ¡å™¨",-1)])]),_:1}),(0,t.bF)(n,{type:"warning","show-icon":"",closable:!1,class:"warning-banner"},{default:(0,t.k6)(()=>[...l[11]||(l[11]=[(0,t.Lk)("span",{class:"warning-text"},"å»ºè®®7å¤©åŒæ­¥ä¸€æ¬¡å¥½å‹(æ³¨æ„ï¼šå¥½å‹æ ‡ç­¾ä¸­ä¸è¦æœ‰ç©ºæ ¼)",-1)])]),_:1})]),(0,t.Lk)("div",ie,[l[15]||(l[15]=(0,t.Lk)("div",{class:"section-header"},[(0,t.Lk)("h4",null,"æ‰‹åŠ¨åŒæ­¥")],-1)),(0,t.Lk)("div",de,[(0,t.Lk)("div",re,[l[12]||(l[12]=(0,t.Lk)("label",{class:"selector-label"},"è´¦å·ï¼š",-1)),(0,t.bF)(u,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value=e),placeholder:"è¯·é€‰æ‹©è´¦å·",style:{width:"200px"}},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.accounts,e=>((0,t.uX)(),(0,t.Wv)(o,{key:e.account_id,label:e.nickname,value:e.account_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),(0,t.Lk)("div",ve,[(0,t.bF)(v,{type:"primary",onClick:l[1]||(l[1]=e=>w("friend")),disabled:!i.value},{default:(0,t.k6)(()=>[...l[13]||(l[13]=[(0,t.eW)(" åŒæ­¥å¥½å‹ ",-1)])]),_:1},8,["disabled"]),(0,t.bF)(v,{type:"primary",onClick:l[2]||(l[2]=e=>w("group")),disabled:!i.value},{default:(0,t.k6)(()=>[...l[14]||(l[14]=[(0,t.eW)(" åŒæ­¥ç¾¤èŠ ",-1)])]),_:1},8,["disabled"])])])]),(0,t.Lk)("div",ke,[l[25]||(l[25]=(0,t.Lk)("div",{class:"section-header"},[(0,t.Lk)("h4",null,"è‡ªåŠ¨åŒæ­¥")],-1)),(0,t.Lk)("div",me,[(0,t.Lk)("div",pe,[l[18]||(l[18]=(0,t.Lk)("label",null,"åŒ æ­¥ é¡¹ï¼š",-1)),(0,t.bF)(_,{modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=e=>g.value=e),disabled:k.value},{default:(0,t.k6)(()=>[(0,t.bF)(h,{label:"friend",disabled:k.value},{default:(0,t.k6)(()=>[...l[16]||(l[16]=[(0,t.eW)("å¥½å‹",-1)])]),_:1},8,["disabled"]),(0,t.bF)(h,{label:"group",disabled:k.value},{default:(0,t.k6)(()=>[...l[17]||(l[17]=[(0,t.eW)("ç¾¤èŠ",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue","disabled"])]),(0,t.Lk)("div",ge,[l[19]||(l[19]=(0,t.Lk)("label",null,"åŒæ­¥é¢‘ç‡ï¼š",-1)),l[20]||(l[20]=(0,t.Lk)("span",null,"æ¯éš”",-1)),(0,t.bF)(V,{modelValue:f.value,"onUpdate:modelValue":l[4]||(l[4]=e=>f.value=e),min:2,max:30,step:1,disabled:k.value,"controls-position":"right"},null,8,["modelValue","disabled"]),l[21]||(l[21]=(0,t.Lk)("span",null,"å¤©",-1))]),(0,t.Lk)("div",fe,[l[22]||(l[22]=(0,t.Lk)("label",null,"æ—¶ é—´ æ®µï¼š",-1)),(0,t.bF)(C,{modelValue:m.value,"onUpdate:modelValue":l[5]||(l[5]=e=>m.value=e),format:"HH:mm",placeholder:"å¼€å§‹æ—¶é—´",disabled:k.value,style:{width:"100px"}},null,8,["modelValue","disabled"]),l[23]||(l[23]=(0,t.Lk)("span",{style:{margin:"0 8px"}},"è‡³",-1)),(0,t.bF)(C,{modelValue:p.value,"onUpdate:modelValue":l[6]||(l[6]=e=>p.value=e),format:"HH:mm",placeholder:"ç»“æŸæ—¶é—´",disabled:k.value,style:{width:"100px"}},null,8,["modelValue","disabled"])]),k.value&&b.value?((0,t.uX)(),(0,t.CE)("div",be,[l[24]||(l[24]=(0,t.Lk)("label",null,"ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´ï¼š",-1)),(0,t.Lk)("span",he,(0,s.v_)(b.value),1)])):(0,t.Q3)("",!0),(0,t.Lk)("div",_e,[(0,t.bF)(E,{modelValue:k.value,"onUpdate:modelValue":l[7]||(l[7]=e=>k.value=e),"active-text":"å·²å¯ç”¨","inactive-text":"å·²å…³é—­",onChange:y},null,8,["modelValue"])])])])]),_:1},8,["modelValue"]),(0,t.bF)(ue,{modelValue:d.value,"onUpdate:modelValue":l[9]||(l[9]=e=>d.value=e),countdown:3,message:r.value,onFinish:L},null,8,["modelValue","message"])],64)}}}),Le=(0,I.A)(we,[["__scopeId","data-v-46261f00"]]),Fe=Le;var Ve=l(8728);const Ce={class:"label-with-icon"},Ee={class:"item-content"},xe={class:"label-with-icon"},We={class:"item-content"},Re={class:"selected-friends"},Ke={class:"label-with-icon"},Ie={class:"label-with-icon"},Xe={class:"item-content"},Ae={class:"frequency-description"},Se={key:0,class:"desc-text"},$e={key:1,class:"desc-text"},Ue={class:"label-with-icon"},ze={class:"item-content"},He={class:"time-range-container"},Te={class:"dialog-footer"},Ge=(0,t.pM)({__name:"AutoFollowConfigDialog",props:{visible:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},selectedFriends:{type:Array,default:()=>[]}},emits:["update:visible","update:modelValue","create"],setup(e,{emit:a}){const l=e,c=a,i=((0,Ve.rd)(),(0,n.KR)([])),d=(0,n.KR)(!1),r=(0,n.KR)({agentId:"",followFrequency:"high",startTime:new Date(2e3,1,1,8,0),endTime:new Date(2e3,1,1,12,0)}),v=(0,t.EW)(()=>{const e=window.innerWidth;return e<768?"95%":e<1200?"80%":"500px"}),k=(0,t.EW)({get:()=>l.visible||l.modelValue,set:e=>{c("update:visible",e),c("update:modelValue",e)}}),m=(0,t.EW)(()=>l.selectedFriends.length<=5?l.selectedFriends.join("ã€"):`${l.selectedFriends.slice(0,5).join("ã€")}ç­‰${l.selectedFriends.length}ä¸ªå®¢æˆ·`),p=async()=>{try{const e=await(0,S.zj)("agents");if(e.success&&e.data){const a=Array.isArray(e.data)?e.data:Array.isArray(e.data.agents)?e.data.agents:[];i.value=a.filter(e=>e.name&&e.botId);const l=i.value.find(e=>e.isDefault);l?r.value.agentId=l.botId:i.value.length>0&&(r.value.agentId=i.value[0].botId)}}catch(e){console.error("åŠ è½½æ™ºèƒ½ä½“é…ç½®å¤±è´¥:",e),o.nk.error("åŠ è½½æ™ºèƒ½ä½“é…ç½®å¤±è´¥")}},g=async()=>{try{if(!r.value.agentId)return void o.nk.warning("è¯·é€‰æ‹©è·Ÿè¿›æ™ºèƒ½ä½“");if(!r.value.startTime||!r.value.endTime)return void o.nk.warning("è¯·é€‰æ‹©æ—¶é—´æ®µ");const e=r.value.startTime.getHours(),a=r.value.startTime.getMinutes(),t=r.value.endTime.getHours(),s=r.value.endTime.getMinutes(),n=60*e+a,u=60*t+s;if(n>=u)return void o.nk.warning("ç»“æŸæ—¶é—´å¿…é¡»æ™šäºå¼€å§‹æ—¶é—´");d.value=!0;const i={agentId:r.value.agentId,followFrequency:r.value.followFrequency,timeRangeStart:`${e.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`,timeRangeEnd:`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`,selectedFriends:l.selectedFriends};c("create",i),k.value=!1}catch(e){console.error("åˆ›å»ºè‡ªåŠ¨è·Ÿå•ä»»åŠ¡å¤±è´¥:",e),o.nk.error("åˆ›å»ºè‡ªåŠ¨è·Ÿå•ä»»åŠ¡å¤±è´¥")}finally{d.value=!1}};return(0,t.sV)(()=>{p()}),(e,a)=>{const l=(0,t.g2)("el-icon"),o=(0,t.g2)("el-option"),c=(0,t.g2)("el-select"),p=(0,t.g2)("el-form-item"),f=(0,t.g2)("el-radio"),b=(0,t.g2)("el-radio-group"),h=(0,t.g2)("el-time-picker"),_=(0,t.g2)("el-form"),y=(0,t.g2)("el-button"),w=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.Wv)(w,{modelValue:k.value,"onUpdate:modelValue":a[5]||(a[5]=e=>k.value=e),title:"è‡ªåŠ¨è·Ÿå•é…ç½®",width:v.value,top:"10vh","close-on-click-modal":!1,class:"auto-follow-config-dialog"},{footer:(0,t.k6)(()=>[(0,t.Lk)("span",Te,[(0,t.bF)(y,{onClick:a[4]||(a[4]=e=>k.value=!1)},{default:(0,t.k6)(()=>[...a[15]||(a[15]=[(0,t.eW)("å–æ¶ˆ",-1)])]),_:1}),(0,t.bF)(y,{type:"primary",onClick:g,loading:d.value},{default:(0,t.k6)(()=>[...a[16]||(a[16]=[(0,t.eW)(" å¼€å¯è‡ªåŠ¨è·Ÿå• ",-1)])]),_:1},8,["loading"])])]),default:(0,t.k6)(()=>[a[17]||(a[17]=(0,t.Lk)("div",{class:"dialog-subtitle"}," è‡ªåŠ¨è”ç³»å®¢æˆ·ï¼Œé‡Šæ”¾AIç”Ÿäº§åŠ› ",-1)),(0,t.bF)(_,{model:r.value,"label-width":"100px",class:"config-form"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{class:"custom-label-form-item"},{label:(0,t.k6)(()=>[(0,t.Lk)("div",Ce,[(0,t.bF)(l,{class:"label-icon"},{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(u.Avatar))]),_:1}),a[6]||(a[6]=(0,t.Lk)("span",null,"è·Ÿè¿›æ™ºèƒ½ä½“ï¼š",-1))])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",Ee,[(0,t.bF)(c,{modelValue:r.value.agentId,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value.agentId=e),placeholder:"é€‰æ‹©æ™ºèƒ½ä½“",class:"select-full-width"},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.value,e=>((0,t.uX)(),(0,t.Wv)(o,{key:e.botId,label:e.name,value:e.botId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),(0,t.bF)(p,{class:"custom-label-form-item"},{label:(0,t.k6)(()=>[(0,t.Lk)("div",xe,[(0,t.bF)(l,{class:"label-icon"},{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(u.User))]),_:1}),a[7]||(a[7]=(0,t.Lk)("span",null,"è·Ÿå•å®¢æˆ·ï¼š",-1))])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",We,[(0,t.Lk)("div",Re,(0,s.v_)(m.value),1)])]),_:1}),(0,t.bF)(p,{class:"custom-label-form-item"},{label:(0,t.k6)(()=>[(0,t.Lk)("div",Ke,[(0,t.bF)(l,{class:"label-icon"},{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(u.Calendar))]),_:1}),a[8]||(a[8]=(0,t.Lk)("span",null,"è·Ÿè¿›å‘¨æœŸï¼š",-1))])]),default:(0,t.k6)(()=>[a[9]||(a[9]=(0,t.Lk)("div",{class:"item-content"},[(0,t.Lk)("div",{class:"follow-period"},[(0,t.Lk)("span",{class:"period-text"},"7"),(0,t.Lk)("span",{class:"period-unit"},"å¤©")])],-1))]),_:1}),(0,t.bF)(p,{class:"custom-label-form-item"},{label:(0,t.k6)(()=>[(0,t.Lk)("div",Ie,[(0,t.bF)(l,{class:"label-icon"},{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(u.Clock))]),_:1}),a[10]||(a[10]=(0,t.Lk)("span",null,"è·Ÿè¿›é¢‘ç‡ï¼š",-1))])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",Xe,[(0,t.bF)(b,{modelValue:r.value.followFrequency,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value.followFrequency=e),class:"frequency-radio"},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"high"},{default:(0,t.k6)(()=>[...a[11]||(a[11]=[(0,t.eW)("é«˜é¢‘",-1)])]),_:1}),(0,t.bF)(f,{label:"medium"},{default:(0,t.k6)(()=>[...a[12]||(a[12]=[(0,t.eW)("ä¸­é¢‘",-1)])]),_:1})]),_:1},8,["modelValue"]),(0,t.Lk)("div",Ae,["high"===r.value.followFrequency?((0,t.uX)(),(0,t.CE)("span",Se," æ¯å¤©è·Ÿè¿›ä¸€æ¬¡ ")):((0,t.uX)(),(0,t.CE)("span",$e," å‰3å¤©æ¯å¤©è·Ÿè¿›ä¸€æ¬¡ï¼Œåé¢æ¯éš”ä¸€å¤©è·Ÿè¿›ä¸€æ¬¡ "))])])]),_:1}),(0,t.bF)(p,{class:"custom-label-form-item"},{label:(0,t.k6)(()=>[(0,t.Lk)("div",Ue,[(0,t.bF)(l,{class:"label-icon"},{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(u.AlarmClock))]),_:1}),a[13]||(a[13]=(0,t.Lk)("span",null,"æ—¶é—´æ®µï¼š",-1))])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",ze,[(0,t.Lk)("div",He,[(0,t.bF)(h,{modelValue:r.value.startTime,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value.startTime=e),format:"HH:mm",placeholder:"å¼€å§‹æ—¶é—´",class:"time-picker"},null,8,["modelValue"]),a[14]||(a[14]=(0,t.Lk)("span",{class:"time-separator"},"â€”",-1)),(0,t.bF)(h,{modelValue:r.value.endTime,"onUpdate:modelValue":a[3]||(a[3]=e=>r.value.endTime=e),format:"HH:mm",placeholder:"ç»“æŸæ—¶é—´",class:"time-picker"},null,8,["modelValue"])])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","width"])}}}),Me=(0,I.A)(Ge,[["__scopeId","data-v-fee52d32"]]),Be=Me;var qe=l(738),Qe=l(8761);const De={class:"customer-management-container"},je={class:"filter-bar"},Oe={class:"filter-content"},Pe={class:"tab-switch"},Je={class:"filter-controls"},Ne={class:"account-option"},Ze={class:"nickname"},Ye={class:"account-id"},ea={class:"content-grid"},aa={class:"contact-list"},la={class:"list-header"},ta={class:"search-box"},sa={class:"list-count-row"},na={class:"list-count"},oa={class:"list-content"},ua={key:0,class:"friends-list"},ca=["onClick"],ia={class:"friend-avatar"},da={class:"avatar-placeholder"},ra={class:"friend-info"},va={class:"friend-name"},ka={class:"friend-wxid"},ma={key:0,class:"friend-tags"},pa={key:0,class:"more-tags"},ga={key:1,class:"groups-list"},fa=["onClick"],ba={class:"group-avatar"},ha={class:"avatar-placeholder group-avatar-bg"},_a={class:"group-info"},ya={class:"group-name"},wa={key:0,class:"friend-tags"},La={key:2,class:"empty-state"},Fa={class:"empty-text"},Va={class:"right-section"},Ca={class:"group-select-container"},Ea={class:"dialog-footer"},xa={class:"set-group-tag-dialog"},Wa={class:"dialog-targets"},Ra={class:"dialog-input"},Ka={class:"dialog-footer"},Ia=(0,t.pM)({__name:"CustomerManagement",setup(e){const a=(0,Ve.rd)(),l=(0,n.KR)("friends"),c=(0,n.KR)(""),i=(0,n.KR)("__ALL__"),d=(0,n.KR)(""),r=(0,n.KR)(!1),v=(0,n.KR)([]),k=(0,n.KR)([]),m=(0,n.KR)([]),p=(0,n.KR)([]),g=(0,n.KR)([]),f=(0,n.KR)([]),b=(0,n.KR)(!1),h=(0,n.KR)(!1),_=(0,n.KR)(!1),y=(0,n.KR)(!1),w=(0,n.KR)(""),L=(0,n.KR)(!1),F=(0,t.EW)(()=>{let e="friends"===l.value?k.value:m.value;return d.value&&(e=e.filter(e=>e.name.toLowerCase().includes(d.value.toLowerCase()))),i.value&&"__ALL__"!==i.value&&(e="friends"===l.value?"æœªåˆ†ç»„"===i.value?e.filter(e=>!e.tags||0===e.tags.length):e.filter(e=>e.tags&&e.tags.includes(i.value)):"æœªåˆ†ç»„"===i.value?e.filter(e=>!("tag"in e)||!e.tag):e.filter(e=>"tag"in e&&e.tag===i.value)),e}),V=(0,t.EW)(()=>{const e="friends"===l.value?g.value:f.value;return F.value.length>0&&F.value.every(a=>e.includes(a.name))}),C=async()=>{try{const e=await fetch("/api/instances/active",{headers:S.b3}),a=await e.json();if(console.log("è·å–æ´»è·ƒå®ä¾‹:",a),a.success)if(v.value=a.instances,1===a.instances.length)c.value=a.instances[0].account_id;else if(a.instances.length>1){const e=a.instances.find(e=>e.is_active);e&&(c.value=e.account_id)}}catch(e){console.error("è·å–æ´»è·ƒå®ä¾‹å¤±è´¥:",e),o.nk.error("è·å–å¾®ä¿¡å®ä¾‹å¤±è´¥")}},E=async()=>{if(c.value){r.value=!0;try{const e="__ALL__"===i.value||"æœªåˆ†ç»„"===i.value?void 0:i.value,a=await(0,qe.kK)(e,d.value,c.value);k.value=a.map(e=>({...e,is_new:e.is_new||!1,last_updated:e.last_updated}))}catch(e){console.error("è·å–å¥½å‹åˆ—è¡¨å¤±è´¥:",e),o.nk.error("è·å–å¥½å‹åˆ—è¡¨å¤±è´¥")}finally{r.value=!1}}},x=async()=>{r.value=!0;try{const e=await(0,qe.f)(d.value,c.value);m.value=e.map(e=>({...e,id:e.name,tag:e.tag}))}catch(e){console.error("è·å–ç¾¤èŠåˆ—è¡¨å¤±è´¥:",e),o.nk.error("è·å–ç¾¤èŠåˆ—è¡¨å¤±è´¥")}finally{r.value=!1}},W=async()=>{if(c.value)try{const e="friends"===l.value?await(0,qe.IZ)(c.value):await(0,qe.dZ)(c.value);p.value=(e||[]).filter(e=>!("æœªåˆ†ç»„"===e.name&&0===(e.count??0)))}catch(e){console.error("è·å–æ ‡ç­¾åˆ—è¡¨å¤±è´¥:",e)}},R=e=>"friends"===l.value?g.value.includes(e):f.value.includes(e),K=(e,a)=>{if("friend"===a){const a=g.value.indexOf(e);a>-1?g.value.splice(a,1):g.value.push(e)}else{const a=f.value.indexOf(e);a>-1?f.value.splice(a,1):f.value.push(e)}},I=e=>{const a=g.value.indexOf(e);a>-1&&g.value.splice(a,1)},X=e=>{const a=f.value.indexOf(e);a>-1&&f.value.splice(a,1)},$=()=>{g.value=[],f.value=[]},U=()=>{"friends"===l.value?g.value:f.value;if(V.value)"friends"===l.value?g.value=[]:f.value=[];else{const e=F.value.map(e=>e.name);"friends"===l.value?g.value=e:f.value=e}},z=async()=>{i.value="__ALL__",d.value="",console.log("activeType.value",l.value,c.value),"friends"===l.value?(await E(),await W()):(await x(),await W())},H=()=>{$(),i.value="__ALL__",d.value="",W(),"friends"===l.value?E():x()},T=()=>{},G=()=>{},M=()=>{b.value=!0},B=()=>{0!==g.value.length?x().then(()=>{h.value=!0}):o.nk.warning("è¯·å…ˆé€‰æ‹©è¦æ‹‰ç¾¤çš„å¥½å‹")},q=()=>{0!==g.value.length?c.value?y.value=!0:o.nk.warning("è¯·å…ˆé€‰æ‹©å¾®ä¿¡è´¦å·"):o.nk.warning("è¯·å…ˆé€‰æ‹©è¦è·Ÿå•çš„å¥½å‹")},Q=()=>{0===f.value.length||g.value.length>0?o.nk.warning("ä»…æ”¯æŒå¯¹é€‰ä¸­çš„ç¾¤èŠæ‰¹é‡è®¾ç½®æ ‡ç­¾"):N()},D=()=>{o.nk.info("åˆ é™¤åŠŸèƒ½å¼€å‘ä¸­...")},j=()=>{_.value=!0},O=async e=>{try{const l={...e,selectedFriends:[...g.value,...f.value],selectedGroups:[],account_id:c.value};console.debug("åˆ›å»ºä»»åŠ¡è¯·æ±‚æ•°æ®:",l),await(0,Qe.Gc)(l),o.nk.success("ä»»åŠ¡åˆ›å»ºæˆåŠŸ"),g.value=[],f.value=[],b.value=!1,a.push({name:"AutoSOP",query:{function:"activate"}})}catch(l){console.error("åˆ›å»ºä»»åŠ¡å¤±è´¥:",l),o.nk.error("åˆ›å»ºä»»åŠ¡å¤±è´¥")}},P=(0,n.KR)(!1),J=(0,n.KR)(""),N=()=>{J.value="",P.value=!0},Z=e=>{const a=e.trim();return!!a&&/^[\u4e00-\u9fffA-Za-z0-9]+$/.test(a)},Y=(0,t.EW)(()=>{const e=J.value.trim(),a=e.length;return Z(e)&&a>=1&&a<=10&&f.value.length>0}),le=(0,t.EW)(()=>{const e=5,a=f.value.slice(0,e).join("ï¼Œ");return f.value.length>e?`${a} ç­‰${f.value.length}ä¸ªç¾¤`:a}),te=async()=>{if(!c.value)return void o.nk.error("è¯·å…ˆé€‰æ‹©å¾®ä¿¡è´¦å·");const e=J.value.trim(),a=e.length;if(!Z(e)||a<1||a>10)o.nk.error("æ ‡ç­¾éœ€ä¸º1-10ä¸ªå­—ç¬¦ï¼ˆæ”¯æŒä¸­è‹±æ–‡å’Œæ•°å­—ï¼‰");else try{const a=await(0,qe.k4)({groups:f.value,tag:e,account_id:c.value});a&&a.success?(o.nk.success("å·²æ‰¹é‡è®¾ç½®ç¾¤æ ‡ç­¾"),P.value=!1,await x()):o.nk.error(a?.error||"è®¾ç½®ç¾¤æ ‡ç­¾å¤±è´¥")}catch(l){o.nk.error("è®¾ç½®ç¾¤æ ‡ç­¾å¤±è´¥")}},se=async e=>{try{const l=g.value.map(e=>{const a=k.value.find(a=>a.name===e);return{wxid:a?.wxid||`wx_${e}`,nickname:e}}),t={account_id:c.value,friends:l,agent_id:e.agentId,follow_scenario:"æ–°å¥½å‹",follow_days:7,follow_frequency:"high"===e.followFrequency?"daily":"medium",time_range_start:e.timeRangeStart,time_range_end:e.timeRangeEnd};console.debug("æ‰¹é‡åˆ›å»ºè‡ªåŠ¨è·Ÿå•ä»»åŠ¡è¯·æ±‚:",t);const s=await(0,Qe.l6)(t);s.success?(o.nk.success(`æˆåŠŸä¸º ${g.value.length} ä¸ªå¥½å‹åˆ›å»ºè‡ªåŠ¨è·Ÿå•ä»»åŠ¡`),g.value=[],a.push({name:"AutoSOP",query:{function:"autofollow"}})):o.nk.error(s.error||"åˆ›å»ºè‡ªåŠ¨è·Ÿå•ä»»åŠ¡å¤±è´¥")}catch(l){console.error("åˆ›å»ºè‡ªåŠ¨è·Ÿå•ä»»åŠ¡å¤±è´¥:",l),o.nk.error(l instanceof Error?l.message:"åˆ›å»ºè‡ªåŠ¨è·Ÿå•ä»»åŠ¡å¤±è´¥")}},ne=async()=>{if(w.value){h.value=!1;try{L.value=!0;const e=await(0,qe.jW)({friends:g.value,targetGroup:w.value,account_id:c.value});e.success?(o.nk.success(`æ‰¹é‡æ‹‰ç¾¤æˆåŠŸï¼Œå·²é‚€è¯· ${e.data.invitedCount} ä½å¥½å‹`),g.value=[],w.value=""):o.nk.error(e.error||"æ‰¹é‡æ‹‰ç¾¤å¤±è´¥")}catch(e){console.error("æ‰¹é‡æ‹‰ç¾¤å¤±è´¥:",e);const a=e instanceof Error?e.message:e?.message||"æ‰¹é‡æ‹‰ç¾¤å¤±è´¥";o.nk.error(a)}finally{L.value=!1}}else o.nk.warning("è¯·é€‰æ‹©ç›®æ ‡ç¾¤èŠ")};(0,t.sV)(async()=>{await C(),c.value&&(await E(),await x(),await W())}),(0,t.wB)(c,()=>{c.value&&(E(),x(),W())}),(0,t.wB)(l,()=>{c.value&&("friends"===l.value&&0===k.value.length?E():"groups"===l.value&&0===m.value.length&&x())});const oe=async e=>{try{"friend"===e.type?(await(0,qe.dH)(e.accountId),o.nk.success("å¥½å‹åŒæ­¥æˆåŠŸ"),await E()):(await(0,qe.cA)(e.accountId),o.nk.success("ç¾¤èŠåŒæ­¥æˆåŠŸ"),await x())}catch(a){console.error("åŒæ­¥å¤±è´¥:",a),o.nk.error(`${"friend"===e.type?"å¥½å‹":"ç¾¤èŠ"}åŒæ­¥å¤±è´¥: ${a?.message||"æœªçŸ¥é”™è¯¯"}`)}};return(e,a)=>{const o=(0,t.g2)("el-radio-button"),k=(0,t.g2)("el-radio-group"),L=(0,t.g2)("el-option"),C=(0,t.g2)("el-select"),E=(0,t.g2)("el-icon"),x=(0,t.g2)("el-input"),W=(0,t.g2)("el-button"),S=(0,t.g2)("el-tag"),Z=(0,t.g2)("el-dialog"),ue=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",De,[(0,t.Lk)("div",je,[(0,t.Lk)("div",Oe,[(0,t.Lk)("div",Pe,[(0,t.bF)(k,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),onChange:z,class:"type-tabs"},{default:(0,t.k6)(()=>[(0,t.bF)(o,{label:"friends"},{default:(0,t.k6)(()=>[...a[13]||(a[13]=[(0,t.eW)("å¥½å‹",-1)])]),_:1}),(0,t.bF)(o,{label:"groups"},{default:(0,t.k6)(()=>[...a[14]||(a[14]=[(0,t.eW)("ç¾¤èŠ",-1)])]),_:1})]),_:1},8,["modelValue"])]),(0,t.Lk)("div",Je,[v.value.length>1?((0,t.uX)(),(0,t.Wv)(C,{key:0,modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),placeholder:"é€‰æ‹©å¾®ä¿¡è´¦å·",onChange:H,class:"account-select",size:"default"},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(v.value,e=>((0,t.uX)(),(0,t.Wv)(L,{key:e.account_id,label:e.nickname,value:e.account_id},{default:(0,t.k6)(()=>[(0,t.Lk)("span",Ne,[(0,t.Lk)("span",Ze,(0,s.v_)(e.nickname),1),(0,t.Lk)("span",Ye,(0,s.v_)(e.account_id),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])):(0,t.Q3)("",!0),(0,t.bF)(C,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=e=>i.value=e),placeholder:"é€‰æ‹©æ ‡ç­¾",onChange:T,class:"tag-select",size:"default","popper-class":"tag-dropdown"},{default:(0,t.k6)(()=>[(0,t.bF)(L,{label:"å…¨éƒ¨",value:"__ALL__"}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.value,e=>((0,t.uX)(),(0,t.Wv)(L,{key:e.id,label:`${e.name} (${e.count})`,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),(0,t.Lk)("div",ea,[(0,t.Lk)("div",aa,[(0,t.Lk)("div",la,[(0,t.Lk)("div",ta,[(0,t.bF)(x,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=e=>d.value=e),placeholder:"æœç´¢å¥½å‹æˆ–ç¾¤èŠ",onInput:G,clearable:"",size:"default"},{prefix:(0,t.k6)(()=>[(0,t.bF)(E,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(u.Search))]),_:1})]),_:1},8,["modelValue"])]),(0,t.Lk)("div",sa,[(0,t.Lk)("span",na,(0,s.v_)("friends"===l.value?"å¥½å‹":"ç¾¤èŠ")+" ("+(0,s.v_)(F.value.length)+") ",1),(0,t.bF)(W,{type:"text",size:"small",onClick:U,disabled:0===F.value.length},{default:(0,t.k6)(()=>[(0,t.eW)((0,s.v_)(V.value?"å–æ¶ˆå…¨é€‰":"å…¨é€‰"),1)]),_:1},8,["disabled"])])]),(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",oa,["friends"===l.value?((0,t.uX)(),(0,t.CE)("div",ua,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(F.value,e=>((0,t.uX)(),(0,t.CE)("div",{key:e.name,class:(0,s.C4)(["friend-item",{selected:R(e.name)}]),onClick:a=>K(e.name,"friend")},[(0,t.Lk)("div",ia,[(0,t.Lk)("div",da,(0,s.v_)(e.name.charAt(0)),1)]),(0,t.Lk)("div",ra,[(0,t.Lk)("div",va,(0,s.v_)(e.name),1),(0,t.Lk)("div",ka,(0,s.v_)(e.wxid||`wx_${e.name}`),1),e.tags&&e.tags.length>0?((0,t.uX)(),(0,t.CE)("div",ma,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.tags.slice(0,2),e=>((0,t.uX)(),(0,t.Wv)(S,{key:e,size:"small",type:"info"},{default:(0,t.k6)(()=>[(0,t.eW)((0,s.v_)(e),1)]),_:2},1024))),128)),e.tags.length>2?((0,t.uX)(),(0,t.CE)("span",pa,"+"+(0,s.v_)(e.tags.length-2),1)):(0,t.Q3)("",!0)])):(0,t.Q3)("",!0)])],10,ca))),128))])):((0,t.uX)(),(0,t.CE)("div",ga,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(F.value,e=>((0,t.uX)(),(0,t.CE)("div",{key:e.name,class:(0,s.C4)(["group-item",{selected:R(e.name)}]),onClick:a=>K(e.name,"group")},[(0,t.Lk)("div",ba,[(0,t.Lk)("div",ha,(0,s.v_)(e.name.charAt(0)),1)]),(0,t.Lk)("div",_a,[(0,t.Lk)("div",ya,(0,s.v_)(e.name),1),e.tag?((0,t.uX)(),(0,t.CE)("div",wa,[(0,t.bF)(S,{size:"small",type:"info"},{default:(0,t.k6)(()=>[(0,t.eW)((0,s.v_)(e.tag),1)]),_:2},1024)])):(0,t.Q3)("",!0)])],10,fa))),128))])),0!==F.value.length||r.value?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",La,[a[15]||(a[15]=(0,t.Lk)("div",{class:"empty-icon"},"ğŸ“­",-1)),(0,t.Lk)("div",Fa,"è¯·å…ˆåŒæ­¥"+(0,s.v_)("friends"===l.value?"å¥½å‹":"ç¾¤èŠ")+"æ•°æ®",1)]))])),[[ue,r.value]])]),(0,t.Lk)("div",Va,[(0,t.bF)(A,{"selected-friends":g.value,"selected-groups":f.value,onRemoveFriend:I,onRemoveGroup:X,onClearAll:$,onSetGroupTag:N,class:"targets-panel"},null,8,["selected-friends","selected-groups"]),(0,t.bF)(ee,{"selected-friends":g.value,"selected-groups":f.value,onMassSend:M,onBatchGroup:B,onAutoFollow:q,onBatchTag:Q,onDelete:D,onOpenSettings:j,class:"operations-panel"},null,8,["selected-friends","selected-groups"])])]),(0,t.bF)(ae.A,{modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=e=>b.value=e),"selected-friends":g.value,"selected-groups":f.value,"wechat-nickname":v.value.find(e=>e.account_id===c.value)?.nickname||"","is-from-sop":!1,onCreate:O},null,8,["modelValue","selected-friends","selected-groups","wechat-nickname"]),(0,t.bF)(Z,{modelValue:h.value,"onUpdate:modelValue":a[7]||(a[7]=e=>h.value=e),title:"é€‰æ‹©ç›®æ ‡ç¾¤èŠ",width:"50%"},{footer:(0,t.k6)(()=>[(0,t.Lk)("span",Ea,[(0,t.bF)(W,{onClick:a[6]||(a[6]=e=>h.value=!1)},{default:(0,t.k6)(()=>[...a[16]||(a[16]=[(0,t.eW)("å–æ¶ˆ",-1)])]),_:1}),(0,t.bF)(W,{type:"primary",onClick:ne,disabled:!w.value},{default:(0,t.k6)(()=>[...a[17]||(a[17]=[(0,t.eW)("ç¡®è®¤",-1)])]),_:1},8,["disabled"])])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",Ca,[(0,t.bF)(C,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=e=>w.value=e),placeholder:"è¯·é€‰æ‹©ç›®æ ‡ç¾¤èŠ",filterable:"",style:{width:"100%"}},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(m.value,e=>((0,t.uX)(),(0,t.Wv)(L,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"]),(0,t.bF)(Z,{modelValue:P.value,"onUpdate:modelValue":a[10]||(a[10]=e=>P.value=e),title:"è®¾ç½®ç¾¤æ ‡ç­¾",width:"500px",class:"group-tag-dialog"},{footer:(0,t.k6)(()=>[(0,t.Lk)("span",Ka,[(0,t.bF)(W,{onClick:a[9]||(a[9]=e=>P.value=!1)},{default:(0,t.k6)(()=>[...a[21]||(a[21]=[(0,t.eW)("å–æ¶ˆ",-1)])]),_:1}),(0,t.bF)(W,{type:"primary",disabled:!Y.value,onClick:te},{default:(0,t.k6)(()=>[...a[22]||(a[22]=[(0,t.eW)("ç¡®è®¤",-1)])]),_:1},8,["disabled"])])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",xa,[a[20]||(a[20]=(0,t.Lk)("div",{class:"dialog-tip"},[(0,t.Lk)("div",null,"æ‰¹é‡è®¾ç½®ç¾¤æ ‡ç­¾ï¼Œä»¥ä¾¿ç»‘å®šAIæ™ºèƒ½ä½“è¿›è¡Œå›å¤"),(0,t.Lk)("div",null,"å¦‚æœç¾¤èŠå·²ç»‘å®šæ ‡ç­¾ï¼Œé‡æ–°è®¾ç½®ä¼šç›´æ¥è¦†ç›–~")],-1)),(0,t.Lk)("div",Wa,[a[18]||(a[18]=(0,t.Lk)("span",{class:"label"},"ç¾¤èŠï¼š",-1)),(0,t.eW)(" "+(0,s.v_)(le.value),1)]),(0,t.Lk)("div",Ra,[a[19]||(a[19]=(0,t.Lk)("span",{class:"label"},"æ ‡ç­¾ï¼š",-1)),(0,t.bF)(x,{modelValue:J.value,"onUpdate:modelValue":a[8]||(a[8]=e=>J.value=e),maxlength:"10","show-word-limit":"",placeholder:"è¯·è¾“å…¥æ ‡ç­¾ï¼ˆ1-10ä¸ªå­—ç¬¦ï¼Œæ”¯æŒä¸­è‹±æ–‡/æ•°å­—ï¼‰"},null,8,["modelValue"])])])]),_:1},8,["modelValue"]),(0,t.bF)(Fe,{modelValue:_.value,"onUpdate:modelValue":a[11]||(a[11]=e=>_.value=e),accounts:v.value,"default-account-id":c.value,onSync:oe},null,8,["modelValue","accounts","default-account-id"]),(0,t.bF)(Be,{modelValue:y.value,"onUpdate:modelValue":a[12]||(a[12]=e=>y.value=e),"selected-friends":g.value,onCreate:se},null,8,["modelValue","selected-friends"])])}}}),Xa=(0,I.A)(Ia,[["__scopeId","data-v-5f77041b"]]),Aa=Xa}}]);
//# sourceMappingURL=618.097d1742.js.map